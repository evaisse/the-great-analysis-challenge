<?php

namespace Chess;

/**
 * Pre-calculated attack tables for move generation optimization
 */
class AttackTables {
    /**
     * Knight attack tables: maps square index (0-63) to array of attacked square indices
     * @var array<int, array<int, int>>
     */
    public const KNIGHT_ATTACKS = [
        0 => [17, 10],
        1 => [16, 18, 11],
        2 => [17, 19, 8, 12],
        3 => [18, 20, 9, 13],
        4 => [19, 21, 10, 14],
        5 => [20, 22, 11, 15],
        6 => [21, 23, 12],
        7 => [22, 13],
        8 => [25, 18, 2],
        9 => [24, 26, 19, 3],
        10 => [25, 27, 16, 20, 0, 4],
        11 => [26, 28, 17, 21, 1, 5],
        12 => [27, 29, 18, 22, 2, 6],
        13 => [28, 30, 19, 23, 3, 7],
        14 => [29, 31, 20, 4],
        15 => [30, 21, 5],
        16 => [33, 26, 10, 1],
        17 => [32, 34, 27, 11, 0, 2],
        18 => [33, 35, 24, 28, 8, 12, 1, 3],
        19 => [34, 36, 25, 29, 9, 13, 2, 4],
        20 => [35, 37, 26, 30, 10, 14, 3, 5],
        21 => [36, 38, 27, 31, 11, 15, 4, 6],
        22 => [37, 39, 28, 12, 5, 7],
        23 => [38, 29, 13, 6],
        24 => [41, 34, 18, 9],
        25 => [40, 42, 35, 19, 8, 10],
        26 => [41, 43, 32, 36, 16, 20, 9, 11],
        27 => [42, 44, 33, 37, 17, 21, 10, 12],
        28 => [43, 45, 34, 38, 18, 22, 11, 13],
        29 => [44, 46, 35, 39, 19, 23, 12, 14],
        30 => [45, 47, 36, 20, 13, 15],
        31 => [46, 37, 21, 14],
        32 => [49, 42, 26, 17],
        33 => [48, 50, 43, 27, 16, 18],
        34 => [49, 51, 40, 44, 24, 28, 17, 19],
        35 => [50, 52, 41, 45, 25, 29, 18, 20],
        36 => [51, 53, 42, 46, 26, 30, 19, 21],
        37 => [52, 54, 43, 47, 27, 31, 20, 22],
        38 => [53, 55, 44, 28, 21, 23],
        39 => [54, 45, 29, 22],
        40 => [57, 50, 34, 25],
        41 => [56, 58, 51, 35, 24, 26],
        42 => [57, 59, 48, 52, 32, 36, 25, 27],
        43 => [58, 60, 49, 53, 33, 37, 26, 28],
        44 => [59, 61, 50, 54, 34, 38, 27, 29],
        45 => [60, 62, 51, 55, 35, 39, 28, 30],
        46 => [61, 63, 52, 36, 29, 31],
        47 => [62, 53, 37, 30],
        48 => [58, 42, 33],
        49 => [59, 43, 32, 34],
        50 => [56, 60, 40, 44, 33, 35],
        51 => [57, 61, 41, 45, 34, 36],
        52 => [58, 62, 42, 46, 35, 37],
        53 => [59, 63, 43, 47, 36, 38],
        54 => [60, 44, 37, 39],
        55 => [61, 45, 38],
        56 => [50, 41],
        57 => [51, 40, 42],
        58 => [48, 52, 41, 43],
        59 => [49, 53, 42, 44],
        60 => [50, 54, 43, 45],
        61 => [51, 55, 44, 46],
        62 => [52, 45, 47],
        63 => [53, 46],
    ];

    /**
     * King attack tables: maps square index (0-63) to array of attacked square indices
     * @var array<int, array<int, int>>
     */
    public const KING_ATTACKS = [
        0 => [8, 9, 1],
        1 => [8, 9, 10, 0, 2],
        2 => [9, 10, 11, 1, 3],
        3 => [10, 11, 12, 2, 4],
        4 => [11, 12, 13, 3, 5],
        5 => [12, 13, 14, 4, 6],
        6 => [13, 14, 15, 5, 7],
        7 => [14, 15, 6],
        8 => [16, 17, 9, 0, 1],
        9 => [16, 17, 18, 8, 10, 0, 1, 2],
        10 => [17, 18, 19, 9, 11, 1, 2, 3],
        11 => [18, 19, 20, 10, 12, 2, 3, 4],
        12 => [19, 20, 21, 11, 13, 3, 4, 5],
        13 => [20, 21, 22, 12, 14, 4, 5, 6],
        14 => [21, 22, 23, 13, 15, 5, 6, 7],
        15 => [22, 23, 14, 6, 7],
        16 => [24, 25, 17, 8, 9],
        17 => [24, 25, 26, 16, 18, 8, 9, 10],
        18 => [25, 26, 27, 17, 19, 9, 10, 11],
        19 => [26, 27, 28, 18, 20, 10, 11, 12],
        20 => [27, 28, 29, 19, 21, 11, 12, 13],
        21 => [28, 29, 30, 20, 22, 12, 13, 14],
        22 => [29, 30, 31, 21, 23, 13, 14, 15],
        23 => [30, 31, 22, 14, 15],
        24 => [32, 33, 25, 16, 17],
        25 => [32, 33, 34, 24, 26, 16, 17, 18],
        26 => [33, 34, 35, 25, 27, 17, 18, 19],
        27 => [34, 35, 36, 26, 28, 18, 19, 20],
        28 => [35, 36, 37, 27, 29, 19, 20, 21],
        29 => [36, 37, 38, 28, 30, 20, 21, 22],
        30 => [37, 38, 39, 29, 31, 21, 22, 23],
        31 => [38, 39, 30, 22, 23],
        32 => [40, 41, 33, 24, 25],
        33 => [40, 41, 42, 32, 34, 24, 25, 26],
        34 => [41, 42, 43, 33, 35, 25, 26, 27],
        35 => [42, 43, 44, 34, 36, 26, 27, 28],
        36 => [43, 44, 45, 35, 37, 27, 28, 29],
        37 => [44, 45, 46, 36, 38, 28, 29, 30],
        38 => [45, 46, 47, 37, 39, 29, 30, 31],
        39 => [46, 47, 38, 30, 31],
        40 => [48, 49, 41, 32, 33],
        41 => [48, 49, 50, 40, 42, 32, 33, 34],
        42 => [49, 50, 51, 41, 43, 33, 34, 35],
        43 => [50, 51, 52, 42, 44, 34, 35, 36],
        44 => [51, 52, 53, 43, 45, 35, 36, 37],
        45 => [52, 53, 54, 44, 46, 36, 37, 38],
        46 => [53, 54, 55, 45, 47, 37, 38, 39],
        47 => [54, 55, 46, 38, 39],
        48 => [56, 57, 49, 40, 41],
        49 => [56, 57, 58, 48, 50, 40, 41, 42],
        50 => [57, 58, 59, 49, 51, 41, 42, 43],
        51 => [58, 59, 60, 50, 52, 42, 43, 44],
        52 => [59, 60, 61, 51, 53, 43, 44, 45],
        53 => [60, 61, 62, 52, 54, 44, 45, 46],
        54 => [61, 62, 63, 53, 55, 45, 46, 47],
        55 => [62, 63, 54, 46, 47],
        56 => [57, 48, 49],
        57 => [56, 58, 48, 49, 50],
        58 => [57, 59, 49, 50, 51],
        59 => [58, 60, 50, 51, 52],
        60 => [59, 61, 51, 52, 53],
        61 => [60, 62, 52, 53, 54],
        62 => [61, 63, 53, 54, 55],
        63 => [62, 54, 55],
    ];

    /**
     * Ray tables for sliding pieces (8 directions Ã— 64 squares)
     * Directions: 0=N, 1=NE, 2=E, 3=SE, 4=S, 5=SW, 6=W, 7=NW
     * @var array<int, array<int, array<int, int>>>
     */
    public const RAY_ATTACKS = [
        0 => [
            0 => [8, 16, 24, 32, 40, 48, 56],
            1 => [9, 18, 27, 36, 45, 54, 63],
            2 => [1, 2, 3, 4, 5, 6, 7],
            3 => [],
            4 => [],
            5 => [],
            6 => [],
            7 => [],
        ],
        1 => [
            0 => [9, 17, 25, 33, 41, 49, 57],
            1 => [10, 19, 28, 37, 46, 55],
            2 => [2, 3, 4, 5, 6, 7],
            3 => [],
            4 => [],
            5 => [],
            6 => [0],
            7 => [8],
        ],
        2 => [
            0 => [10, 18, 26, 34, 42, 50, 58],
            1 => [11, 20, 29, 38, 47],
            2 => [3, 4, 5, 6, 7],
            3 => [],
            4 => [],
            5 => [],
            6 => [1, 0],
            7 => [9, 16],
        ],
        3 => [
            0 => [11, 19, 27, 35, 43, 51, 59],
            1 => [12, 21, 30, 39],
            2 => [4, 5, 6, 7],
            3 => [],
            4 => [],
            5 => [],
            6 => [2, 1, 0],
            7 => [10, 17, 24],
        ],
        4 => [
            0 => [12, 20, 28, 36, 44, 52, 60],
            1 => [13, 22, 31],
            2 => [5, 6, 7],
            3 => [],
            4 => [],
            5 => [],
            6 => [3, 2, 1, 0],
            7 => [11, 18, 25, 32],
        ],
        5 => [
            0 => [13, 21, 29, 37, 45, 53, 61],
            1 => [14, 23],
            2 => [6, 7],
            3 => [],
            4 => [],
            5 => [],
            6 => [4, 3, 2, 1, 0],
            7 => [12, 19, 26, 33, 40],
        ],
        6 => [
            0 => [14, 22, 30, 38, 46, 54, 62],
            1 => [15],
            2 => [7],
            3 => [],
            4 => [],
            5 => [],
            6 => [5, 4, 3, 2, 1, 0],
            7 => [13, 20, 27, 34, 41, 48],
        ],
        7 => [
            0 => [15, 23, 31, 39, 47, 55, 63],
            1 => [],
            2 => [],
            3 => [],
            4 => [],
            5 => [],
            6 => [6, 5, 4, 3, 2, 1, 0],
            7 => [14, 21, 28, 35, 42, 49, 56],
        ],
        8 => [
            0 => [16, 24, 32, 40, 48, 56],
            1 => [17, 26, 35, 44, 53, 62],
            2 => [9, 10, 11, 12, 13, 14, 15],
            3 => [1],
            4 => [0],
            5 => [],
            6 => [],
            7 => [],
        ],
        9 => [
            0 => [17, 25, 33, 41, 49, 57],
            1 => [18, 27, 36, 45, 54, 63],
            2 => [10, 11, 12, 13, 14, 15],
            3 => [2],
            4 => [1],
            5 => [0],
            6 => [8],
            7 => [16],
        ],
        10 => [
            0 => [18, 26, 34, 42, 50, 58],
            1 => [19, 28, 37, 46, 55],
            2 => [11, 12, 13, 14, 15],
            3 => [3],
            4 => [2],
            5 => [1],
            6 => [9, 8],
            7 => [17, 24],
        ],
        11 => [
            0 => [19, 27, 35, 43, 51, 59],
            1 => [20, 29, 38, 47],
            2 => [12, 13, 14, 15],
            3 => [4],
            4 => [3],
            5 => [2],
            6 => [10, 9, 8],
            7 => [18, 25, 32],
        ],
        12 => [
            0 => [20, 28, 36, 44, 52, 60],
            1 => [21, 30, 39],
            2 => [13, 14, 15],
            3 => [5],
            4 => [4],
            5 => [3],
            6 => [11, 10, 9, 8],
            7 => [19, 26, 33, 40],
        ],
        13 => [
            0 => [21, 29, 37, 45, 53, 61],
            1 => [22, 31],
            2 => [14, 15],
            3 => [6],
            4 => [5],
            5 => [4],
            6 => [12, 11, 10, 9, 8],
            7 => [20, 27, 34, 41, 48],
        ],
        14 => [
            0 => [22, 30, 38, 46, 54, 62],
            1 => [23],
            2 => [15],
            3 => [7],
            4 => [6],
            5 => [5],
            6 => [13, 12, 11, 10, 9, 8],
            7 => [21, 28, 35, 42, 49, 56],
        ],
        15 => [
            0 => [23, 31, 39, 47, 55, 63],
            1 => [],
            2 => [],
            3 => [],
            4 => [7],
            5 => [6],
            6 => [14, 13, 12, 11, 10, 9, 8],
            7 => [22, 29, 36, 43, 50, 57],
        ],
        16 => [
            0 => [24, 32, 40, 48, 56],
            1 => [25, 34, 43, 52, 61],
            2 => [17, 18, 19, 20, 21, 22, 23],
            3 => [9, 2],
            4 => [8, 0],
            5 => [],
            6 => [],
            7 => [],
        ],
        17 => [
            0 => [25, 33, 41, 49, 57],
            1 => [26, 35, 44, 53, 62],
            2 => [18, 19, 20, 21, 22, 23],
            3 => [10, 3],
            4 => [9, 1],
            5 => [8],
            6 => [16],
            7 => [24],
        ],
        18 => [
            0 => [26, 34, 42, 50, 58],
            1 => [27, 36, 45, 54, 63],
            2 => [19, 20, 21, 22, 23],
            3 => [11, 4],
            4 => [10, 2],
            5 => [9, 0],
            6 => [17, 16],
            7 => [25, 32],
        ],
        19 => [
            0 => [27, 35, 43, 51, 59],
            1 => [28, 37, 46, 55],
            2 => [20, 21, 22, 23],
            3 => [12, 5],
            4 => [11, 3],
            5 => [10, 1],
            6 => [18, 17, 16],
            7 => [26, 33, 40],
        ],
        20 => [
            0 => [28, 36, 44, 52, 60],
            1 => [29, 38, 47],
            2 => [21, 22, 23],
            3 => [13, 6],
            4 => [12, 4],
            5 => [11, 2],
            6 => [19, 18, 17, 16],
            7 => [27, 34, 41, 48],
        ],
        21 => [
            0 => [29, 37, 45, 53, 61],
            1 => [30, 39],
            2 => [22, 23],
            3 => [14, 7],
            4 => [13, 5],
            5 => [12, 3],
            6 => [20, 19, 18, 17, 16],
            7 => [28, 35, 42, 49, 56],
        ],
        22 => [
            0 => [30, 38, 46, 54, 62],
            1 => [31],
            2 => [23],
            3 => [15],
            4 => [14, 6],
            5 => [13, 4],
            6 => [21, 20, 19, 18, 17, 16],
            7 => [29, 36, 43, 50, 57],
        ],
        23 => [
            0 => [31, 39, 47, 55, 63],
            1 => [],
            2 => [],
            3 => [],
            4 => [15, 7],
            5 => [14, 5],
            6 => [22, 21, 20, 19, 18, 17, 16],
            7 => [30, 37, 44, 51, 58],
        ],
        24 => [
            0 => [32, 40, 48, 56],
            1 => [33, 42, 51, 60],
            2 => [25, 26, 27, 28, 29, 30, 31],
            3 => [17, 10, 3],
            4 => [16, 8, 0],
            5 => [],
            6 => [],
            7 => [],
        ],
        25 => [
            0 => [33, 41, 49, 57],
            1 => [34, 43, 52, 61],
            2 => [26, 27, 28, 29, 30, 31],
            3 => [18, 11, 4],
            4 => [17, 9, 1],
            5 => [16],
            6 => [24],
            7 => [32],
        ],
        26 => [
            0 => [34, 42, 50, 58],
            1 => [35, 44, 53, 62],
            2 => [27, 28, 29, 30, 31],
            3 => [19, 12, 5],
            4 => [18, 10, 2],
            5 => [17, 8],
            6 => [25, 24],
            7 => [33, 40],
        ],
        27 => [
            0 => [35, 43, 51, 59],
            1 => [36, 45, 54, 63],
            2 => [28, 29, 30, 31],
            3 => [20, 13, 6],
            4 => [19, 11, 3],
            5 => [18, 9, 0],
            6 => [26, 25, 24],
            7 => [34, 41, 48],
        ],
        28 => [
            0 => [36, 44, 52, 60],
            1 => [37, 46, 55],
            2 => [29, 30, 31],
            3 => [21, 14, 7],
            4 => [20, 12, 4],
            5 => [19, 10, 1],
            6 => [27, 26, 25, 24],
            7 => [35, 42, 49, 56],
        ],
        29 => [
            0 => [37, 45, 53, 61],
            1 => [38, 47],
            2 => [30, 31],
            3 => [22, 15],
            4 => [21, 13, 5],
            5 => [20, 11, 2],
            6 => [28, 27, 26, 25, 24],
            7 => [36, 43, 50, 57],
        ],
        30 => [
            0 => [38, 46, 54, 62],
            1 => [39],
            2 => [31],
            3 => [23],
            4 => [22, 14, 6],
            5 => [21, 12, 3],
            6 => [29, 28, 27, 26, 25, 24],
            7 => [37, 44, 51, 58],
        ],
        31 => [
            0 => [39, 47, 55, 63],
            1 => [],
            2 => [],
            3 => [],
            4 => [23, 15, 7],
            5 => [22, 13, 4],
            6 => [30, 29, 28, 27, 26, 25, 24],
            7 => [38, 45, 52, 59],
        ],
        32 => [
            0 => [40, 48, 56],
            1 => [41, 50, 59],
            2 => [33, 34, 35, 36, 37, 38, 39],
            3 => [25, 18, 11, 4],
            4 => [24, 16, 8, 0],
            5 => [],
            6 => [],
            7 => [],
        ],
        33 => [
            0 => [41, 49, 57],
            1 => [42, 51, 60],
            2 => [34, 35, 36, 37, 38, 39],
            3 => [26, 19, 12, 5],
            4 => [25, 17, 9, 1],
            5 => [24],
            6 => [32],
            7 => [40],
        ],
        34 => [
            0 => [42, 50, 58],
            1 => [43, 52, 61],
            2 => [35, 36, 37, 38, 39],
            3 => [27, 20, 13, 6],
            4 => [26, 18, 10, 2],
            5 => [25, 16],
            6 => [33, 32],
            7 => [41, 48],
        ],
        35 => [
            0 => [43, 51, 59],
            1 => [44, 53, 62],
            2 => [36, 37, 38, 39],
            3 => [28, 21, 14, 7],
            4 => [27, 19, 11, 3],
            5 => [26, 17, 8],
            6 => [34, 33, 32],
            7 => [42, 49, 56],
        ],
        36 => [
            0 => [44, 52, 60],
            1 => [45, 54, 63],
            2 => [37, 38, 39],
            3 => [29, 22, 15],
            4 => [28, 20, 12, 4],
            5 => [27, 18, 9, 0],
            6 => [35, 34, 33, 32],
            7 => [43, 50, 57],
        ],
        37 => [
            0 => [45, 53, 61],
            1 => [46, 55],
            2 => [38, 39],
            3 => [30, 23],
            4 => [29, 21, 13, 5],
            5 => [28, 19, 10, 1],
            6 => [36, 35, 34, 33, 32],
            7 => [44, 51, 58],
        ],
        38 => [
            0 => [46, 54, 62],
            1 => [47],
            2 => [39],
            3 => [31],
            4 => [30, 22, 14, 6],
            5 => [29, 20, 11, 2],
            6 => [37, 36, 35, 34, 33, 32],
            7 => [45, 52, 59],
        ],
        39 => [
            0 => [47, 55, 63],
            1 => [],
            2 => [],
            3 => [],
            4 => [31, 23, 15, 7],
            5 => [30, 21, 12, 3],
            6 => [38, 37, 36, 35, 34, 33, 32],
            7 => [46, 53, 60],
        ],
        40 => [
            0 => [48, 56],
            1 => [49, 58],
            2 => [41, 42, 43, 44, 45, 46, 47],
            3 => [33, 26, 19, 12, 5],
            4 => [32, 24, 16, 8, 0],
            5 => [],
            6 => [],
            7 => [],
        ],
        41 => [
            0 => [49, 57],
            1 => [50, 59],
            2 => [42, 43, 44, 45, 46, 47],
            3 => [34, 27, 20, 13, 6],
            4 => [33, 25, 17, 9, 1],
            5 => [32],
            6 => [40],
            7 => [48],
        ],
        42 => [
            0 => [50, 58],
            1 => [51, 60],
            2 => [43, 44, 45, 46, 47],
            3 => [35, 28, 21, 14, 7],
            4 => [34, 26, 18, 10, 2],
            5 => [33, 24],
            6 => [41, 40],
            7 => [49, 56],
        ],
        43 => [
            0 => [51, 59],
            1 => [52, 61],
            2 => [44, 45, 46, 47],
            3 => [36, 29, 22, 15],
            4 => [35, 27, 19, 11, 3],
            5 => [34, 25, 16],
            6 => [42, 41, 40],
            7 => [50, 57],
        ],
        44 => [
            0 => [52, 60],
            1 => [53, 62],
            2 => [45, 46, 47],
            3 => [37, 30, 23],
            4 => [36, 28, 20, 12, 4],
            5 => [35, 26, 17, 8],
            6 => [43, 42, 41, 40],
            7 => [51, 58],
        ],
        45 => [
            0 => [53, 61],
            1 => [54, 63],
            2 => [46, 47],
            3 => [38, 31],
            4 => [37, 29, 21, 13, 5],
            5 => [36, 27, 18, 9, 0],
            6 => [44, 43, 42, 41, 40],
            7 => [52, 59],
        ],
        46 => [
            0 => [54, 62],
            1 => [55],
            2 => [47],
            3 => [39],
            4 => [38, 30, 22, 14, 6],
            5 => [37, 28, 19, 10, 1],
            6 => [45, 44, 43, 42, 41, 40],
            7 => [53, 60],
        ],
        47 => [
            0 => [55, 63],
            1 => [],
            2 => [],
            3 => [],
            4 => [39, 31, 23, 15, 7],
            5 => [38, 29, 20, 11, 2],
            6 => [46, 45, 44, 43, 42, 41, 40],
            7 => [54, 61],
        ],
        48 => [
            0 => [56],
            1 => [57],
            2 => [49, 50, 51, 52, 53, 54, 55],
            3 => [41, 34, 27, 20, 13, 6],
            4 => [40, 32, 24, 16, 8, 0],
            5 => [],
            6 => [],
            7 => [],
        ],
        49 => [
            0 => [57],
            1 => [58],
            2 => [50, 51, 52, 53, 54, 55],
            3 => [42, 35, 28, 21, 14, 7],
            4 => [41, 33, 25, 17, 9, 1],
            5 => [40],
            6 => [48],
            7 => [56],
        ],
        50 => [
            0 => [58],
            1 => [59],
            2 => [51, 52, 53, 54, 55],
            3 => [43, 36, 29, 22, 15],
            4 => [42, 34, 26, 18, 10, 2],
            5 => [41, 32],
            6 => [49, 48],
            7 => [57],
        ],
        51 => [
            0 => [59],
            1 => [60],
            2 => [52, 53, 54, 55],
            3 => [44, 37, 30, 23],
            4 => [43, 35, 27, 19, 11, 3],
            5 => [42, 33, 24],
            6 => [50, 49, 48],
            7 => [58],
        ],
        52 => [
            0 => [60],
            1 => [61],
            2 => [53, 54, 55],
            3 => [45, 38, 31],
            4 => [44, 36, 28, 20, 12, 4],
            5 => [43, 34, 25, 16],
            6 => [51, 50, 49, 48],
            7 => [59],
        ],
        53 => [
            0 => [61],
            1 => [62],
            2 => [54, 55],
            3 => [46, 39],
            4 => [45, 37, 29, 21, 13, 5],
            5 => [44, 35, 26, 17, 8],
            6 => [52, 51, 50, 49, 48],
            7 => [60],
        ],
        54 => [
            0 => [62],
            1 => [63],
            2 => [55],
            3 => [47],
            4 => [46, 38, 30, 22, 14, 6],
            5 => [45, 36, 27, 18, 9, 0],
            6 => [53, 52, 51, 50, 49, 48],
            7 => [61],
        ],
        55 => [
            0 => [63],
            1 => [],
            2 => [],
            3 => [],
            4 => [47, 39, 31, 23, 15, 7],
            5 => [46, 37, 28, 19, 10, 1],
            6 => [54, 53, 52, 51, 50, 49, 48],
            7 => [62],
        ],
        56 => [
            0 => [],
            1 => [],
            2 => [57, 58, 59, 60, 61, 62, 63],
            3 => [49, 42, 35, 28, 21, 14, 7],
            4 => [48, 40, 32, 24, 16, 8, 0],
            5 => [],
            6 => [],
            7 => [],
        ],
        57 => [
            0 => [],
            1 => [],
            2 => [58, 59, 60, 61, 62, 63],
            3 => [50, 43, 36, 29, 22, 15],
            4 => [49, 41, 33, 25, 17, 9, 1],
            5 => [48],
            6 => [56],
            7 => [],
        ],
        58 => [
            0 => [],
            1 => [],
            2 => [59, 60, 61, 62, 63],
            3 => [51, 44, 37, 30, 23],
            4 => [50, 42, 34, 26, 18, 10, 2],
            5 => [49, 40],
            6 => [57, 56],
            7 => [],
        ],
        59 => [
            0 => [],
            1 => [],
            2 => [60, 61, 62, 63],
            3 => [52, 45, 38, 31],
            4 => [51, 43, 35, 27, 19, 11, 3],
            5 => [50, 41, 32],
            6 => [58, 57, 56],
            7 => [],
        ],
        60 => [
            0 => [],
            1 => [],
            2 => [61, 62, 63],
            3 => [53, 46, 39],
            4 => [52, 44, 36, 28, 20, 12, 4],
            5 => [51, 42, 33, 24],
            6 => [59, 58, 57, 56],
            7 => [],
        ],
        61 => [
            0 => [],
            1 => [],
            2 => [62, 63],
            3 => [54, 47],
            4 => [53, 45, 37, 29, 21, 13, 5],
            5 => [52, 43, 34, 25, 16],
            6 => [60, 59, 58, 57, 56],
            7 => [],
        ],
        62 => [
            0 => [],
            1 => [],
            2 => [63],
            3 => [55],
            4 => [54, 46, 38, 30, 22, 14, 6],
            5 => [53, 44, 35, 26, 17, 8],
            6 => [61, 60, 59, 58, 57, 56],
            7 => [],
        ],
        63 => [
            0 => [],
            1 => [],
            2 => [],
            3 => [],
            4 => [55, 47, 39, 31, 23, 15, 7],
            5 => [54, 45, 36, 27, 18, 9, 0],
            6 => [62, 61, 60, 59, 58, 57, 56],
            7 => [],
        ],
    ];

    /**
     * Converts row and column to square index (0-63)
     * Row 0 = rank 8 (a8-h8), Row 7 = rank 1 (a1-h1)
     * Col 0 = file a, Col 7 = file h
     * 
     * Note: Row is inverted (7 - row) because PHP's internal board representation
     * uses row 0 for rank 8, but the attack table indices use 0 for a1.
     */
    public static function square_index(int $row, int $col): int {
        return (7 - $row) * 8 + $col;
    }

    /**
     * Converts square index to [row, col]
     * Returns [row, col] where row 0 = rank 8, row 7 = rank 1
     * 
     * Note: Row is inverted (7 - rank) to match PHP's internal board representation
     * where row 0 represents rank 8.
     */
    public static function index_to_square(int $index): array {
        $row = 7 - intdiv($index, 8);
        $col = $index % 8;
        return [$row, $col];
    }

    /**
     * Chebyshev distance (max of abs differences) between two squares
     */
    public static function chebyshev_distance(int $sq1, int $sq2): int {
        [$r1, $c1] = self::index_to_square($sq1);
        [$r2, $c2] = self::index_to_square($sq2);
        return max(abs($r1 - $r2), abs($c1 - $c2));
    }

    /**
     * Manhattan distance (sum of abs differences) between two squares
     */
    public static function manhattan_distance(int $sq1, int $sq2): int {
        [$r1, $c1] = self::index_to_square($sq1);
        [$r2, $c2] = self::index_to_square($sq2);
        return abs($r1 - $r2) + abs($c1 - $c2);
    }
}
